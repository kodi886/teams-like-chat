<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue Agent Chat</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-dark text-light">
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Left sidebar - Chat history -->
            <div class="col-3 chat-history-sidebar">
                <div class="sidebar-header">
                    <h5>對話紀錄</h5>
                    <div class="search-container">
                        <i class="bi bi-search"></i>
                        <input type="text" class="search-input" placeholder="搜尋">
                    </div>
                    <div class="display-mode-toggle">
                        <button class="mode-btn active" data-mode="summary">摘要模式</button>
                        <button class="mode-btn" data-mode="tags">標籤模式</button>
                    </div>
                </div>
                <div class="chat-list">
                    <div class="chat-item active">
                        <div class="avatar issue-avatar">IS-1234</div>
                        <div class="chat-info">
                            <div class="chat-name">記憶體洩漏問題</div>
                            <div class="chat-preview summary-mode">應用程式在長時間運行後出現記憶體洩漏問題...</div>
                            <div class="chat-preview tags-mode" style="display: none;">
                                <span class="tag">記憶體</span>
                                <span class="tag">性能</span>
                                <span class="tag">緊急</span>
                            </div>
                        </div>
                        <div class="chat-time">12:30</div>
                    </div>
                    <div class="chat-item">
                        <div class="avatar issue-avatar">IS-1235</div>
                        <div class="chat-info">
                            <div class="chat-name">API 回應緩慢</div>
                            <div class="chat-preview summary-mode">用戶報告API在高流量時回應時間超過預期...</div>
                            <div class="chat-preview tags-mode" style="display: none;">
                                <span class="tag">API</span>
                                <span class="tag">效能</span>
                                <span class="tag">重要</span>
                            </div>
                        </div>
                        <div class="chat-time">昨天</div>
                    </div>
                    <div class="chat-item">
                        <div class="avatar issue-avatar">2025-03-08</div>
                        <div class="chat-info">
                            <div class="chat-name">每日系統檢查</div>
                            <div class="chat-preview summary-mode">例行系統檢查，發現網絡延遲異常...</div>
                            <div class="chat-preview tags-mode" style="display: none;">
                                <span class="tag">監控</span>
                                <span class="tag">網絡</span>
                                <span class="tag">例行</span>
                            </div>
                        </div>
                        <div class="chat-time">3/8</div>
                    </div>
                    <!-- More chat items can be added here -->
                </div>
            </div>

            <!-- Middle - Chat window -->
            <div class="col-6 chat-window">
                <div class="chat-header">
                    <div class="d-flex align-items-center">
                        <div class="avatar issue-avatar">IS-1234</div>
                        <div class="chat-title">
                            <h5>記憶體洩漏問題</h5>
                            <div class="issue-tags">
                                <span class="tag">記憶體</span>
                                <span class="tag">性能</span>
                                <span class="tag">緊急</span>
                            </div>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button class="action-btn" title="上傳檔案"><i class="bi bi-upload"></i></button>
                        <button class="action-btn" title="贊同"><i class="bi bi-hand-thumbs-up"></i></button>
                        <button class="action-btn" title="不贊同"><i class="bi bi-hand-thumbs-down"></i></button>
                        <button class="action-btn" title="更多選項"><i class="bi bi-three-dots"></i></button>
                    </div>
                </div>
                <div class="messages-container">
                    <div class="date-divider">
                        <span>今天</span>
                    </div>
                    <div class="message received">
                        <div class="message-avatar">IS</div>
                        <div class="message-content">
                            <div class="message-sender">系統</div>
                            <div class="message-text">已建立新的問題報告：記憶體洩漏問題 (IS-1234)</div>
                            <div class="message-time">10:30</div>
                        </div>
                    </div>
                    <div class="message received">
                        <div class="message-avatar">JD</div>
                        <div class="message-content">
                            <div class="message-sender">John Doe</div>
                            <div class="message-text">我們發現在長時間運行後，後端服務記憶體使用率持續增加，沒有恢復跡象。特別是處理大量資料的模組。</div>
                            <div class="message-time">10:32</div>
                        </div>
                    </div>
                    <div class="message sent">
                        <div class="message-content">
                            <div class="message-text">我會檢查一下記憶體分析報告，請提供最近的伺服器日誌。</div>
                            <div class="message-time">10:33</div>
                        </div>
                    </div>
                    <div class="message received">
                        <div class="message-avatar">JD</div>
                        <div class="message-content">
                            <div class="message-sender">John Doe</div>
                            <div class="message-text">這是最近的記憶體分析圖表</div>
                            <div class="message-image">
                                <img src="/api/placeholder/500/300" alt="記憶體分析圖表">
                            </div>
                            <div class="message-time">10:40</div>
                        </div>
                    </div>
                    <div class="typing-indicator">
                        <div class="avatar">JD</div>
                        <div class="dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    </div>
                </div>
                <div class="message-input-container">
                    <div class="message-toolbar">
                        <button class="toolbar-btn" id="imageUploadBtn"><i class="bi bi-image"></i></button>
                        <button class="toolbar-btn"><i class="bi bi-emoji-smile"></i></button>
                        <button class="toolbar-btn"><i class="bi bi-paperclip"></i></button>
                    </div>
                    <div class="message-input-wrapper">
                        <textarea class="message-input" placeholder="輸入訊息..."></textarea>
                        <button class="send-btn"><i class="bi bi-send-fill"></i></button>
                    </div>
                </div>
            </div>

            <!-- Right sidebar - Files and Trace -->
            <div class="col-3 files-sidebar">
                <div class="sidebar-section files-section" id="filesSection">
                    <div class="sidebar-header">
                        <h5>檔案列表</h5>
                        <div class="source-selector">
                            <button class="source-btn active" data-source="all">全部</button>
                            <button class="source-btn" data-source="elg">ELG</button>
                            <button class="source-btn" data-source="csv">CSV</button>
                            <button class="source-btn" data-source="remote">遠端</button>
                        </div>
                        <button class="upload-btn" id="fileUploadBtn"><i class="bi bi-upload"></i> 上傳檔案</button>
                        <input type="file" id="fileUploadInput" multiple style="display: none;">
                    </div>
                    <div class="files-list">
                        <div class="file-item" data-source="elg">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="file1">
                                <label class="form-check-label" for="file1">
                                    <i class="bi bi-file-earmark-text"></i>
                                    <span class="file-name">system_log.elg</span>
                                </label>
                            </div>
                            <div class="file-info">3.2 MB · 昨天</div>
                        </div>
                        <div class="file-item" data-source="csv">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="file2">
                                <label class="form-check-label" for="file2">
                                    <i class="bi bi-file-earmark-spreadsheet"></i>
                                    <span class="file-name">memory_stats.csv</span>
                                </label>
                            </div>
                            <div class="file-info">1.5 MB · 3/7</div>
                        </div>
                        <div class="file-item" data-source="remote">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="file3">
                                <label class="form-check-label" for="file3">
                                    <i class="bi bi-cloud"></i>
                                    <span class="file-name">server_profile.bin</span>
                                </label>
                            </div>
                            <div class="file-info">4.7 MB · 3/5</div>
                        </div>
                        <!-- More file items can be added here -->
                    </div>
                    <div class="files-actions">
                        <button class="action-btn"><i class="bi bi-download"></i> 下載</button>
                        <button class="action-btn"><i class="bi bi-trash"></i> 刪除</button>
                    </div>
                </div>
                <div class="sidebar-section trace-section" id="traceSection">
                    <div class="sidebar-header">
                        <h5>Trace 列表</h5>
                        <div class="trace-type-selector">
                            <button class="trace-type-btn active" data-type="all">全部</button>
                            <button class="trace-type-btn" data-type="group">Group</button>
                            <button class="trace-type-btn" data-type="custom">自定義</button>
                            <button class="trace-type-btn" data-type="customGroup">自定群組</button>
                        </div>
                    </div>
                    <div class="trace-list">
                        <div class="trace-item" data-type="group">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="trace1" checked>
                                <label class="form-check-label" for="trace1">
                                    <span class="trace-name">Memory Allocation</span>
                                </label>
                            </div>
                        </div>
                        <div class="trace-item" data-type="custom">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="trace2">
                                <label class="form-check-label" for="trace2">
                                    <span class="trace-name">Network Calls</span>
                                </label>
                            </div>
                        </div>
                        <div class="trace-item" data-type="customGroup">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="trace3">
                                <label class="form-check-label" for="trace3">
                                    <span class="trace-name">Error Handling</span>
                                </label>
                            </div>
                        </div>
                        <!-- More trace items can be added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="websocket-manager.js"></script>
    <script src="script-js.js"></script>
</body>
</html>
